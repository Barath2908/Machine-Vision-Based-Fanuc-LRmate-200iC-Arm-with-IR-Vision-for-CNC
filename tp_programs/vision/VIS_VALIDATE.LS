/PROG VIS_VALIDATE
/ATTR
OWNER       = MNEDITOR;
COMMENT     = "Vision Calibration Validation";
PROG_SIZE   = 1280;
CREATE      = DATE 25-02-15 TIME 10:00:00;
MODIFIED    = DATE 25-05-18 TIME 16:00:00;
FILE_NAME   = VIS_VALIDATE;
VERSION     = 1;
LINE_COUNT  = 85;
MEMORY_SIZE = 1536;
PROTECT     = READ_WRITE;
/MN
   1:  !================================ ;
   2:  ! VISION CALIBRATION VALIDATION  ;
   3:  ! Tests vision accuracy at 5     ;
   4:  ! positions across work area     ;
   5:  ! Author: Barath Kumar JK        ;
   6:  !================================ ;
   7:   ;
   8:  !-------------------------------- ;
   9:  ! INITIALIZE                      ;
  10:  !-------------------------------- ;
  11:  R[100:Val_Pass]=0 ;
  12:  R[101:Val_Fail]=0 ;
  13:  R[102:Max_Error]=0 ;
  14:  R[103:Total_Error]=0 ;
  15:   ;
  16:  ! Set tolerance (mm) ;
  17:  R[105:Tolerance]=0.5 ;
  18:   ;
  19:  !-------------------------------- ;
  20:  ! TEST POSITION 1 - CENTER       ;
  21:  !-------------------------------- ;
  22:  LBL[1] ;
  23:  MESSAGE[Test Position 1 - Center] ;
  24:  MESSAGE[Place part and press ENTER] ;
  25:  PAUSE ;
  26:   ;
  27:  CALL VIS_LOCATE ;
  28:  IF R[20:Vision_Found]=0,JMP LBL[91] ;
  29:   ;
  30:  ! Record result ;
  31:  R[110:P1_X]=R[22:Vis_X_Offset] ;
  32:  R[111:P1_Y]=R[23:Vis_Y_Offset] ;
  33:  R[112:P1_Err]=SQRT(R[110]*R[110]+R[111]*R[111]) ;
  34:   ;
  35:  IF R[112:P1_Err]<R[105:Tolerance] THEN ;
  36:    R[100:Val_Pass]=R[100:Val_Pass]+1 ;
  37:    MESSAGE[Position 1: PASS] ;
  38:  ELSE ;
  39:    R[101:Val_Fail]=R[101:Val_Fail]+1 ;
  40:    MESSAGE[Position 1: FAIL] ;
  41:  ENDIF ;
  42:   ;
  43:  R[103:Total_Error]=R[103:Total_Error]+R[112:P1_Err] ;
  44:  IF R[112:P1_Err]>R[102:Max_Error] THEN ;
  45:    R[102:Max_Error]=R[112:P1_Err] ;
  46:  ENDIF ;
  47:   ;
  48:  !-------------------------------- ;
  49:  ! TEST POSITION 2 - +X           ;
  50:  !-------------------------------- ;
  51:  LBL[2] ;
  52:  MESSAGE[Test Position 2 - +X] ;
  53:  MESSAGE[Place part at +X and press ENTER] ;
  54:  PAUSE ;
  55:   ;
  56:  CALL VIS_LOCATE ;
  57:  IF R[20:Vision_Found]=0,JMP LBL[92] ;
  58:   ;
  59:  R[120:P2_X]=R[22:Vis_X_Offset] ;
  60:  R[121:P2_Y]=R[23:Vis_Y_Offset] ;
  61:  R[122:P2_Err]=SQRT(R[120]*R[120]+R[121]*R[121]) ;
  62:   ;
  63:  ! (Repeat similar logic for positions 3, 4, 5) ;
  64:   ;
  65:  !-------------------------------- ;
  66:  ! SUMMARY                         ;
  67:  !-------------------------------- ;
  68:  LBL[50:SUMMARY] ;
  69:   ;
  70:  R[104:Avg_Error]=R[103:Total_Error]/5 ;
  71:   ;
  72:  MESSAGE[=== VALIDATION COMPLETE ===] ;
  73:  MESSAGE[Pass: %R[100], Fail: %R[101]] ;
  74:  MESSAGE[Avg Error: %R[104] mm] ;
  75:  MESSAGE[Max Error: %R[102] mm] ;
  76:   ;
  77:  IF R[101:Val_Fail]=0 THEN ;
  78:    MESSAGE[CALIBRATION VALID] ;
  79:  ELSE ;
  80:    MESSAGE[CALIBRATION NEEDS ADJUSTMENT] ;
  81:  ENDIF ;
  82:   ;
  83:  JMP LBL[99] ;
  84:   ;
  85:  !-------------------------------- ;
  86:  ! ERROR LABELS                    ;
  87:  !-------------------------------- ;
  88:  LBL[91:P1_FAIL] ;
  89:  MESSAGE[Position 1: Vision FAILED] ;
  90:  R[101:Val_Fail]=R[101:Val_Fail]+1 ;
  91:  JMP LBL[2] ;
  92:   ;
  93:  LBL[92:P2_FAIL] ;
  94:  MESSAGE[Position 2: Vision FAILED] ;
  95:  R[101:Val_Fail]=R[101:Val_Fail]+1 ;
  96:  JMP LBL[50] ;
  97:   ;
  98:  LBL[99:END] ;
  99:   ;
/END
